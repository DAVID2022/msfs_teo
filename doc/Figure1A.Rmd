---
title: "FigureA"
output: NULL
author: Jinliang Yang
date: 09-20-2020
---


```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
knitr::opts_knit$set(root.dir=normalizePath('../')) 
#library(tidyverse)
```


### plot the results:


```{r}
library("tidyr")
library(ggplot2)
df <- read.csv("cache/response_ne.csv")
df$context <- gsub(".*new_msfs_|_pops.*", "", df$par)
#df <- gather(data=df0, key=k, value="p", 1:3)
df$val <- 10^-(df$mn)
df <- df[order(df$val),-5]
subset(df, context %in% "CG" & type == "mu")
subset(df, context %in% "CHG" & type == "mu")

subset(df, context %in% "CG" & type == "nu")
subset(df, context %in% "CHG" & type == "nu")

subset(df, context %in% "CG" & type == "s")
subset(df, context %in% "CHG" & type == "s")
```

```{r}
fsize=18
df$ne <- factor(df$ne, levels = c("50000", "1e+05", "5e+05", "1e+06"))

p1 <- ggplot(df, aes(x=type, y=mn, fill=ne)) +
    geom_bar(stat="identity", position=position_dodge()) +
    facet_grid( . ~ context) +
    xlab("Posterior Estimates") +
    ylab("Value") +
    geom_errorbar(aes(ymin=mn-sd*100, ymax=mn+sd*100), width=.2,
                 position=position_dodge(.9)) +
    # https://www.color-hex.com/color-palette/73961
    scale_fill_manual(values=c("#cc4141", "#72114b", "#e1cd07", "#5f9057"),
                      name=c("Ne"),
                      labels=c("5e+4", "1e+5", "5e+5", "1e+6")) +
    #scale_fill_manual(values=c("#cc4141", "#72114b", "#e1cd07", "#5f9057", "#114c63")) +
    #labs(fill = "Dose (mg)") +
    scale_x_discrete(labels=c("-log10(mu)","-log10(nu)", "Ne*s")) +
    theme(legend.position = c(0.9, 0.7), plot.title = element_text(size=20), axis.text=element_text(size=15),
          strip.text.x = element_text(size = 20, face = "bold"),
          axis.title=element_text(size=fsize, face="bold"),
                legend.title = element_text(size=fsize, face="bold"),
                legend.text = element_text(size=fsize))
  #########

p1

```




```{r}
library("cowplot")
pdf("graphs/SFig_Ne.pdf", width=12, height=5)
plot_grid(p1, ncol=1, labels = NULL, label_size = 26)
dev.off()
```

